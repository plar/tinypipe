============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /home/runner/work/justpipe/justpipe
configfile: pyproject.toml
testpaths: tests
plugins: benchmark-5.2.3, anyio-4.12.1, hypothesis-6.151.4, repeat-0.9.4, cov-7.0.0, asyncio-1.3.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 563 items

tests/functional/concurrency/test_backpressure.py ...                    [  0%]
tests/functional/concurrency/test_concurrency.py .........               [  2%]
tests/functional/concurrency/test_map_limit.py ...                       [  2%]
tests/functional/error_handling/test_barrier_timeout.py ....             [  3%]
tests/functional/error_handling/test_cancellation.py .....               [  4%]
tests/functional/error_handling/test_error_handling.py .............     [  6%]
tests/functional/error_handling/test_timeout.py .....                    [  7%]
tests/functional/test_barrier_types.py ........                          [  8%]
tests/functional/test_cli_commands.py .............                      [ 11%]
tests/functional/test_client_close_status.py .                           [ 11%]
tests/functional/test_event_ordering.py ...........                      [ 13%]
tests/functional/test_examples_execution.py ......                       [ 14%]
tests/functional/test_injection.py ........                              [ 15%]
tests/functional/test_lifecycle.py .........                             [ 17%]
tests/functional/test_middleware.py ........                             [ 18%]
tests/functional/test_pipe_immutability.py ....                          [ 19%]
tests/functional/test_pipeline_meta.py .........                         [ 21%]
tests/functional/test_pipeline_persistence.py .........                  [ 22%]
tests/functional/test_return_value_warnings.py .......                   [ 23%]
tests/functional/test_routing.py ............                            [ 26%]
tests/functional/test_runtime_contracts.py ........                      [ 27%]
tests/functional/test_runtime_metrics_functional.py ...                  [ 28%]
tests/functional/test_start_scope_validation.py ..                       [ 28%]
tests/functional/test_testpipe_harness.py .......                        [ 29%]
tests/fuzzing/test_fuzz_advanced.py ......                               [ 30%]
tests/fuzzing/test_fuzz_pipeline.py ..........                           [ 32%]
tests/integration/storage/test_sqlite_storage_integration.py ..........  [ 34%]
tests/unit/definition/test_injection_validation.py .....                 [ 35%]
tests/unit/definition/test_registration_definition.py ......             [ 36%]
tests/unit/definition/test_registry_validator.py ......                  [ 37%]
tests/unit/definition/test_signature_analysis.py ...........             [ 39%]
tests/unit/definition/test_types_resolution.py ...                       [ 39%]
tests/unit/observability/test_compare.py .                               [ 39%]
tests/unit/observability/test_observability_barrier.py ....              [ 40%]
tests/unit/observability/test_observability_logger.py ..............     [ 43%]
tests/unit/observability/test_observability_state.py .......             [ 44%]
tests/unit/observability/test_timeline.py .....                          [ 45%]
tests/unit/observability/test_validate_observer.py ........              [ 46%]
tests/unit/runtime/test_barriers.py ...                                  [ 47%]
tests/unit/runtime/test_event_publisher.py ......                        [ 48%]
tests/unit/runtime/test_failure_handler.py .....                         [ 49%]
tests/unit/runtime/test_invoker_guards.py .....                          [ 50%]
tests/unit/runtime/test_lifecycle_mgr.py .....                           [ 50%]
tests/unit/runtime/test_result_handler_raise.py ..                       [ 51%]
tests/unit/runtime/test_runner_composition.py .                          [ 51%]
tests/unit/runtime/test_runner_error_paths.py ......                     [ 52%]
tests/unit/runtime/test_runtime_kernel.py ...                            [ 53%]
tests/unit/runtime/test_runtime_metrics.py .                             [ 53%]
tests/unit/runtime/test_state_machine_invariants.py ...                  [ 53%]
tests/unit/runtime/test_step_execution.py .......                        [ 55%]
tests/unit/shared/test_cancellation_token.py .....                       [ 55%]
tests/unit/shared/test_events.py ........                                [ 57%]
tests/unit/shared/test_structures.py .....                               [ 58%]
tests/unit/shared/test_tracker.py ........                               [ 59%]
tests/unit/storage/test_storage.py ........................              [ 63%]
tests/unit/test_cli.py ....                                              [ 64%]
tests/unit/test_cli_export.py .                                          [ 64%]
tests/unit/test_cli_formatting.py .............                          [ 67%]
tests/unit/test_cli_main_dispatch.py ...                                 [ 67%]
tests/unit/test_cli_registry.py ..............                           [ 70%]
tests/unit/test_dashboard_api.py ...................                     [ 73%]
tests/unit/test_dashboard_path_traversal.py ..                           [ 73%]
tests/unit/test_dashboard_serializers.py ................                [ 76%]
tests/unit/test_describe.py ......                                       [ 77%]
tests/unit/test_examples_utils.py ....                                   [ 78%]
tests/unit/test_execution_log.py ....                                    [ 79%]
tests/unit/test_introspection.py ............                            [ 81%]
tests/unit/test_meta.py ...............................                  [ 86%]
tests/unit/test_middleware_unit.py ...                                   [ 87%]
tests/unit/test_persistence.py ....................                      [ 90%]
tests/unit/test_pipe_configuration.py ....                               [ 91%]
tests/unit/test_pipeline_hash.py ........                                [ 93%]
tests/unit/test_plan.py .....                                            [ 93%]
tests/unit/test_terminal_status.py .                                     [ 94%]
tests/unit/test_testpipe_state_tracking.py ..                            [ 94%]
tests/unit/visualization/test_visualization_builder.py .............     [ 96%]
tests/unit/visualization/test_visualization_model.py ......              [ 97%]
tests/unit/visualization/test_visualization_renderer.py ............     [100%]

================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                                                                 Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------------------------------
justpipe/__init__.py                                                     5      0   100%
justpipe/_internal/__init__.py                                           0      0   100%
justpipe/_internal/definition/__init__.py                                0      0   100%
justpipe/_internal/definition/middleware_coordinator.py                 33      2    94%   25, 50
justpipe/_internal/definition/pipeline_registry.py                      75      0   100%
justpipe/_internal/definition/registry_validator.py                     44      4    91%   20-21, 27, 89
justpipe/_internal/definition/step_registry.py                         137      4    97%   231, 282, 287, 353
justpipe/_internal/definition/steps.py                                 125      7    94%   68, 72, 146-147, 190, 210, 213
justpipe/_internal/definition/type_resolver.py                          62      3    95%   44-46, 55
justpipe/_internal/graph/__init__.py                                     0      0   100%
justpipe/_internal/graph/dependency_graph.py                            88      4    95%   64, 125-126, 152
justpipe/_internal/graph/execution_plan.py                              21      0   100%
justpipe/_internal/graph/graph_validator.py                            156     16    90%   44, 100, 104, 122, 127-129, 177, 194, 261, 282-285, 301-302
justpipe/_internal/runtime/__init__.py                                   0      0   100%
justpipe/_internal/runtime/engine/__init__.py                            0      0   100%
justpipe/_internal/runtime/engine/composition.py                        53      0   100%
justpipe/_internal/runtime/engine/pipeline_runner.py                   226      1    99%   177
justpipe/_internal/runtime/engine/run_context.py                        31      0   100%
justpipe/_internal/runtime/engine/run_state.py                          40      1    98%   72
justpipe/_internal/runtime/execution/__init__.py                         0      0   100%
justpipe/_internal/runtime/execution/result_handler.py                  51      3    94%   72-87
justpipe/_internal/runtime/execution/scheduler.py                       90      2    98%   83-84
justpipe/_internal/runtime/execution/step_error_store.py                14      1    93%   16
justpipe/_internal/runtime/execution/step_execution_coordinator.py      48      0   100%
justpipe/_internal/runtime/execution/step_invoker.py                    77      6    92%   55, 114, 125-128
justpipe/_internal/runtime/failure/__init__.py                           0      0   100%
justpipe/_internal/runtime/failure/failure_handler.py                   45      0   100%
justpipe/_internal/runtime/meta.py                                     116      2    98%   169-171
justpipe/_internal/runtime/orchestration/__init__.py                     0      0   100%
justpipe/_internal/runtime/orchestration/barrier_manager.py             51      0   100%
justpipe/_internal/runtime/orchestration/control.py                     25      0   100%
justpipe/_internal/runtime/orchestration/event_manager.py               56      0   100%
justpipe/_internal/runtime/orchestration/event_publisher.py             15      0   100%
justpipe/_internal/runtime/orchestration/lifecycle_manager.py           34      1    97%   91
justpipe/_internal/runtime/orchestration/orchestrator.py                72      2    97%   52, 58
justpipe/_internal/runtime/orchestration/protocols.py                   39      0   100%
justpipe/_internal/runtime/orchestration/runtime_kernel.py              34      1    97%   26
justpipe/_internal/runtime/persistence.py                              126     10    92%   62, 119-120, 142, 148-149, 180-181, 244-245
justpipe/_internal/runtime/telemetry/__init__.py                         0      0   100%
justpipe/_internal/runtime/telemetry/execution_log.py                   63      1    98%   140
justpipe/_internal/runtime/telemetry/failure_journal.py                 38     15    61%   67, 83-121, 127, 130
justpipe/_internal/runtime/telemetry/runtime_metrics.py                106      0   100%
justpipe/_internal/shared/__init__.py                                    0      0   100%
justpipe/_internal/shared/execution_tracker.py                          30      0   100%
justpipe/_internal/shared/pipeline_hash.py                              10      0   100%
justpipe/_internal/shared/utils.py                                      37      2    95%   42, 48
justpipe/cli/__init__.py                                                 1      0   100%
justpipe/cli/commands/__init__.py                                        1      0   100%
justpipe/cli/commands/cleanup.py                                        86     41    52%   33-34, 39, 52, 55, 59-60, 90-93, 102-139
justpipe/cli/commands/compare.py                                        18      2    89%   18, 22
justpipe/cli/commands/dashboard.py                                      22     22     0%   3-39
justpipe/cli/commands/export.py                                         43     10    77%   15-19, 50-52, 56, 86
justpipe/cli/commands/list.py                                           41      9    78%   28-29, 59-67, 78
justpipe/cli/commands/pipelines.py                                      47      6    87%   24-25, 62-67
justpipe/cli/commands/show.py                                           44      3    93%   42, 62, 72
justpipe/cli/commands/stats.py                                         110     19    83%   25-26, 32-33, 54, 111-115, 149, 153, 157, 170-172, 180-184
justpipe/cli/commands/timeline.py                                       42     21    50%   24-25, 43-64
justpipe/cli/formatting.py                                              37      4    89%   53, 69-71
justpipe/cli/main.py                                                    78      5    94%   7-8, 146-148, 157
justpipe/cli/registry.py                                                72      4    94%   46, 50, 60-61
justpipe/dashboard/__init__.py                                           0      0   100%
justpipe/dashboard/api.py                                               88      6    93%   52-53, 74-75, 100-101
justpipe/dashboard/serializers.py                                       49      0   100%
justpipe/dashboard/server.py                                            69     69     0%   6-117
justpipe/failures.py                                                     2      2     0%   12-22
justpipe/middleware.py                                                  55      8    85%   12-24
justpipe/observability/__init__.py                                      37      4    89%   68, 81, 94, 107
justpipe/observability/_step_pairing.py                                 30      0   100%
justpipe/observability/_worker_cleanup.py                               11      3    73%   16-18
justpipe/observability/barrier.py                                       92      2    98%   126-127
justpipe/observability/compare.py                                       83      8    90%   114, 121, 129, 131, 151, 153, 155-156
justpipe/observability/logger.py                                       111     15    86%   98, 117, 148-149, 151-152, 157-158, 167-168, 178-179, 186, 193, 210
justpipe/observability/state.py                                        151     23    85%   53-55, 69-71, 80-81, 106, 112-113, 142-145, 163, 174, 206, 231, 236-241, 252, 278, 290-291
justpipe/observability/timeline.py                                     163     65    60%   88-96, 125, 131-136, 142-144, 150-152, 158, 163, 167, 199, 225-226, 262, 279-324, 359-388
justpipe/pipe.py                                                       131      7    95%   45, 126-128, 139, 143, 312, 314
justpipe/storage/__init__.py                                             4      0   100%
justpipe/storage/interface.py                                           32      0   100%
justpipe/storage/memory.py                                              50      0   100%
justpipe/storage/sqlite.py                                             102     13    87%   90, 139-162
justpipe/testing.py                                                    109     27    75%   22, 40-44, 82-90, 140-153, 197-199
justpipe/types.py                                                      227      1    99%   290
justpipe/visualization/__init__.py                                      20      2    90%   56-57
justpipe/visualization/ast.py                                           40      0   100%
justpipe/visualization/builder.py                                       94      7    93%   62, 95, 105-107, 200-202
justpipe/visualization/mermaid.py                                      215     54    75%   105, 134, 199-211, 215-221, 245-259, 280, 286-295, 300-318, 332, 340, 353, 355
justpipe/visualization/renderer.py                                       6      0   100%
--------------------------------------------------------------------------------------------------
TOTAL                                                                 4886    550    89%
============================= 563 passed in 13.98s =============================
